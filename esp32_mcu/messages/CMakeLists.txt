# messages component - contains pre-generated protobuf files
# Files are generated by nanopb and should be regenerated when proto files change

# Note: Run the following command to regenerate when proto files change:
# cd components/nanopb/generator
# python3 nanopb_generator.py -D ../../messages -f ../../../proto/messages.options -I ../../../proto ../../../proto/messages.proto

set(GENERATED_SOURCES
    "${CMAKE_CURRENT_SOURCE_DIR}/messages.pb.c"
)

set(GENERATED_HEADERS  
    "${CMAKE_CURRENT_SOURCE_DIR}/messages.pb.h"
)

# Register the component
idf_component_register(
    SRCS ${GENERATED_SOURCES}
    INCLUDE_DIRS ${CMAKE_CURRENT_SOURCE_DIR}
    PRIV_REQUIRES nanopb
)

# Include nanopb source directory for pb_common.h, pb_decode.h, pb_encode.h
target_include_directories(${COMPONENT_LIB} PUBLIC 
    "${CMAKE_CURRENT_SOURCE_DIR}/../components/nanopb/nanopb-0.4.9.1"
)